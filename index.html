<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××ª×•×¨×’××Ÿ ×—×›× - ×¢×•×‘×“-×× ×”×œ</title>

    <!-- Tailwind CSS CDN - ××©××© ×œ×¢×™×¦×•×‘ ××”×™×¨ ×•××•×“×¨× ×™ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ×¤×•× ×˜ Heebo ××ª××™× ×œ×¢×‘×¨×™×ª ×•×œ××¨××” × ×§×™ */
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap');
        /* ×¤×•× ×˜ ×œ×ª××™×ª */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap');
    </style>

    <!-- simple-keyboard CSS CDN - ×¢×‘×•×¨ ×”××§×œ×“×ª ×”×•×•×™×¨×˜×•××œ×™×ª -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">

    <style>
        /* ×”×’×“×¨×•×ª ×¤×•× ×˜ ×•×¨×™×¡×˜ ×›×œ×œ×™×•×ª ×œ×’×•×£ ×”×“×£ */
        body {
            font-family: 'Heebo', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* ×¨×§×¢ ×›×—×•×œ-×œ×‘×Ÿ ×¢× ×”×“×¨×’×ª×™×•×ª */
            background: linear-gradient(135deg, #e0f2fe 0%, #bbdefb 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px; /* ×”×’×“×œ ×¤×“×™× ×’ ×›×œ×œ×™ */
            gap: 32px; /* ××¨×•×•×— ×’×“×•×œ ×™×•×ª×¨ ×‘×™×Ÿ ×¡×§×©× ×™× */
            overflow-x: hidden; /* ×œ×× ×•×¢ ×’×œ×™×œ×” ××•×¤×§×™×ª ××™×•×ª×¨×ª */
        }

        /* ×”×¡×ª×¨×ª × ×’×Ÿ ×”××•×“×™×• ×”××•×‘× ×” ×©×œ ×”×“×¤×“×¤×Ÿ */
        audio {
            display: none;
        }

        /* ×¢×™×¦×•×‘ ×–×›×•×›×™×ª (Glassmorphism) ×œ×¤×× ×œ×™× ×•×œ×—×œ×§ ××”×›×¤×ª×•×¨×™× */
        .glass-panel {
            background-color: rgba(255, 255, 255, 0.6); /* ×¨×§×¢ ×œ×‘×Ÿ ×©×§×•×£ */
            backdrop-filter: blur(10px); /* ××¤×§×˜ ×˜×©×˜×•×© */
            border: 1px solid rgba(255, 255, 255, 0.3); /* ×’×‘×•×œ ×©×§×•×£ */
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37); /* ×¦×œ ×¢×“×™×Ÿ */
            border-radius: 20px; /* ×¤×™× ×•×ª ×¢×’×•×œ×•×ª ×™×•×ª×¨ */
        }

        /* ×”×’×“×¨×•×ª ×‘×¡×™×¡×™×•×ª ×©×œ simple-keyboard ×›×“×™ ×œ×”×ª××™× ×œ×¢×™×¦×•×‘ ×”×›×œ×œ×™ ×©×œ Tailwind */
        .simple-keyboard {
            @apply glass-panel p-6 max-w-4xl mx-auto;
        }
        .simple-keyboard .hg-button {
            @apply rounded-xl text-lg font-medium text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 transition-all duration-150;
            padding: 0.8rem 0.5rem;
        }
        .simple-keyboard .hg-button.hg-standardBtn {
            @apply h-14;
        }
        .simple-keyboard .hg-button.hg-functionBtn {
            @apply bg-blue-500 text-white hover:bg-blue-600;
        }
        .simple-keyboard .hg-button.hg-button-space {
            @apply w-full;
        }
        .simple-keyboard .hg-button-shift,
        .simple-keyboard .hg-button-capslock,
        .simple-keyboard .hg-button-tab,
        .simple-keyboard .hg-button-bksp {
            @apply bg-gray-300 text-gray-800 hover:bg-gray-400;
        }
        .simple-keyboard .hg-button-shift:active,
        .simple-keyboard .hg-button-capslock:active {
            @apply bg-gray-500;
        }
        .simple-keyboard .hg-row .hg-button {
            line-height: normal;
        }

        /* ×× ×™××¦×™×™×ª ×”×‘×”×•×‘ ×¢×‘×•×¨ ×”×¤×•×¤××¤ - ××•×©×š ×ª×©×•××ª ×œ×‘ */
        @keyframes pulse-once {
            0% { transform: scale(1); opacity: 1; box-shadow: 0 0 0 rgba(0, 0, 0, 0); }
            50% { transform: scale(1.02); opacity: 1; box-shadow: 0 0 20px rgba(0, 0, 0, 0.4); }
            100% { transform: scale(1); opacity: 1; box-shadow: 0 0 0 rgba(0, 0, 0, 0); }
        }

        @keyframes urgent-pulse {
            0% { background-color: rgba(255, 99, 71, 0.7); box-shadow: 0 0 15px rgba(255, 99, 71, 0.8); }
            50% { background-color: rgba(255, 140, 0, 0.7); box-shadow: 0 0 30px rgba(255, 140, 0, 0.8); }
            100% { background-color: rgba(255, 99, 71, 0.7); box-shadow: 0 0 15px rgba(255, 99, 71, 0.8); }
        }

        .popup-animate {
            animation: pulse-once 1.5s ease-out forwards;
        }
        .urgent-popup-animate {
            animation: urgent-pulse 1s infinite alternate; /* ×× ×™××¦×™×” ××ª×—×œ×¤×ª ×•××’×¨×¡×™×‘×™×ª ×™×•×ª×¨ */
        }

        /* ×× ×™××¦×™×™×ª ×‘×¨×§ ×•×§×©×ª ×¦×‘×¢×™× ×œ××¡×š ×”×ª×¨×’×•× ×”×¨××©×™ */
        @keyframes rainbow-glow {
            0% { border-color: #ff0000; box-shadow: 0 0 15px #ff0000; }
            16% { border-color: #ff7f00; box-shadow: 0 0 15px #ff7f00; }
            33% { border-color: #ffff00; box-shadow: 0 0 15px #ffff00; }
            50% { border-color: #00ff00; box-shadow: 0 0 15px #00ff00; }
            66% { border-color: #0000ff; box-shadow: 0 0 15px #0000ff; }
            83% { border-color: #4b0082; box-shadow: 0 0 15px #4b0082; }
            100% { border-color: #9400d3; box-shadow: 0 0 15px #9400d3; }
        }

        .rainbow-border {
            border: 4px solid; /* ×¢×‘×” ×™×•×ª×¨ ×‘×©×‘×™×œ ×”××¤×§×˜ */
            animation: rainbow-glow 3s infinite alternate; /* ×× ×™××¦×™×” ××™× ×¡×•×¤×™×ª ×•××ª×—×œ×¤×ª */
        }
        
        /* ××¤×§×˜ ×”×§×œ×“×” */
        .typing-effect span {
            border-right: 3px solid; /* ×¡×™××Ÿ ×”×¡××Ÿ */
            overflow: hidden; /* ×œ×•×•×“× ×©×”×˜×§×¡×˜ ×œ× ×’×•×œ×© ×œ×¤× ×™ ×©×”×•×©×œ× */
            white-space: nowrap; /* ×œ×× ×•×¢ ×©×‘×™×¨×ª ×©×•×¨×•×ª */
            display: inline-block; /* ×›×“×™ ×©×”-overflow ×™×¢×‘×•×“ */
            vertical-align: bottom; /* ×œ×× ×•×¢ ×¨×•×•×— ××™×•×ª×¨ ××ª×—×ª */
        }

        .typing-effect span::after {
            content: ''; /* ××•× ×¢ ×¡××Ÿ × ×•×¡×£ ×‘-after */
            animation: none; /* ××•× ×¢ ×× ×™××¦×™×” ×©×œ ×¡××Ÿ ×¢×œ span */
        }

        .typing-effect::after {
            content: '|';
            animation: blink-caret .75s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-right-color: transparent }
            50% { border-right-color: black; }
        }

        /* ×¤×•× ×˜ ×¢×‘×•×¨ ×˜×§×¡×˜ ×ª××™×ª */
        .thai-text {
            font-family: 'Noto Sans Thai', sans-serif;
        }

        /* ×”×ª×××” ×œ×¨×¡×¤×•× ×¡×™×‘×™×•×ª ×©×œ ×”××§×œ×“×ª */
        @media (max-width: 768px) {
            .simple-keyboard .hg-button {
                font-size: 0.9em;
                padding: 0.5rem 0.3rem;
            }
            .simple-keyboard .hg-button.hg-standardBtn {
                height: 3.5rem; /* ×’×•×‘×” ×§×˜×Ÿ ×™×•×ª×¨ ×œ××¡×›×™× ×§×˜× ×™× */
            }
        }

        /* ×¢×™×¦×•×‘ ×›×¤×ª×•×¨ ×‘×–××Ÿ ×¡×¤×™×¨×” ×œ××—×•×¨ */
        @keyframes border-sparkle {
            0% { border-color: #ff0000; box-shadow: 0 0 10px #ff0000; }
            25% { border-color: #ff7f00; box-shadow: 0 0 15px #ff7f00; }
            50% { border-color: #ffff00; box-shadow: 0 0 20px #ffff00; }
            75% { border-color: #ff7f00; box-shadow: 0 0 15px #ff7f00; }
            100% { border-color: #ff0000; box-shadow: 0 0 10px #ff0000; }
        }

        .countdown-button {
            background-color: #ffc107 !important; /* ×¦×‘×¢ ×¦×”×•×‘ ×‘×–××Ÿ ×¡×¤×™×¨×” */
            color: #333 !important; /* ×˜×§×¡×˜ ×›×”×” ×™×•×ª×¨ */
            pointer-events: none; /* ××•× ×¢ ×œ×—×™×¦×•×ª × ×•×¡×¤×•×ª */
            transform: scale(1.05); /* ××¤×§×˜ ×§×˜×Ÿ ×©×œ ×”×’×“×œ×” */
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.7);
            border: 3px solid transparent; /* ×’×‘×•×œ ×”×ª×—×œ×ª×™ ×©×§×•×£ ×œ×× ×™××¦×™×” */
            animation: border-sparkle 1s infinite alternate; /* ×× ×™××¦×™×™×ª ×”×‘×¨×§×” ×¢×œ ×”×’×‘×•×œ */
        }

        /* ×¡×’× ×•×Ÿ ×œ××¡×š ×”×ª×¨×’×•× ×”×¨××©×™ ×”×—×“×© */
        #mainTranslationDisplay {
            min-height: 150px; /* ×’×•×‘×” ××™× ×™××œ×™ ×œ××¡×š */
            background-color: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 10px 40px 0 rgba(31, 38, 135, 0.4);
            border-radius: 25px;
            font-size: 3.5rem; /* ×’×•×“×œ ×¤×•× ×˜ ×’×“×•×œ ×‘××™×•×—×“ */
            font-weight: 700; /* ×‘×•×œ×“ */
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            overflow: hidden; /* ×œ××§×¨×” ×©×œ ×’×œ×™×©×ª ×˜×§×¡×˜ ×‘×× ×™××¦×™×™×ª ×”×§×œ×“×” */
            position: relative;
            z-index: 10; /* ×•×•×“× ×©×”×•× ××¢×œ ×©××¨ ×”×ª×•×›×Ÿ */
        }
        /* ×”×ª×××•×ª ×œ××¡×›×™× ×§×˜× ×™× ×¢×‘×•×¨ ×”××¡×š ×”×¨××©×™ */
        @media (max-width: 768px) {
            #mainTranslationDisplay {
                font-size: 2.5rem; /* ×§×˜×Ÿ ×™×•×ª×¨ ×œ× ×™×™×“ */
                min-height: 120px;
            }
        }
        @media (max-width: 480px) {
            #mainTranslationDisplay {
                font-size: 1.8rem;
                min-height: 100px;
            }
        }

        /* ×× ×™××¦×™×™×ª ×’×“×™×œ×” ×•×‘×¨×§ ×œ××™××•×’'×™ ×‘×¤×•×¤××¤ */
        @keyframes emoji-grow-sparkle {
            0% { transform: scale(1); filter: drop-shadow(0 0 0 rgba(255, 255, 0, 0)); }
            50% { transform: scale(1.5); filter: drop-shadow(0 0 20px rgba(255, 255, 0, 0.8)); }
            100% { transform: scale(1); filter: drop-shadow(0 0 0 rgba(255, 255, 0, 0)); }
        }

        .emoji-sparkle-animate {
            animation: emoji-grow-sparkle 0.8s ease-out;
        }

        /* ×¢×™×¦×•×‘ ×›×¤×ª×•×¨ ×¨×’×™×œ ×•×¢×™×¦×•×‘ ×“×—×•×£ */
        .phrase-button {
            @apply flex flex-col items-center justify-center p-4 rounded-xl shadow-lg transition-all duration-200 cursor-pointer text-lg font-semibold text-gray-800 hover:scale-105 transform;
            min-width: 120px; /* ×¨×•×—×‘ ××™× ×™××œ×™ ×œ×›×¤×ª×•×¨ */
            min-height: 100px; /* ×’×•×‘×” ××™× ×™××œ×™ ×œ×›×¤×ª×•×¨ */
            word-break: break-word; /* ×œ×©×‘×•×¨ ××™×œ×™× ××¨×•×›×•×ª */
            text-align: center;
            background-color: rgba(255, 255, 255, 0.8);
            border: 2px solid transparent; /* ×’×‘×•×œ ×©×§×•×£ ×œ×”×ª×—×œ×” */
            position: relative; /* ×¢×‘×•×¨ ××™×§×•× ×”××™××•×’'×™ */
            overflow: hidden; /* ×œ×•×•×“× ×©×”××™××•×’'×™ ×œ× ×—×•×¨×’ ××”×›×¤×ª×•×¨ */
        }
        .phrase-button .emoji-background { /* ×©× ×§×œ××¡ ×—×“×© ×œ××™××•×’'×™ ×‘×¨×§×¢ */
            font-size: 3rem; /* ×’×•×“×œ ××™××•×’'×™ ×‘×›×¤×ª×•×¨ */
            margin-bottom: 0.5rem;
            transition: transform 0.2s ease-out;
            position: absolute; /* ××™××•×’'×™ ×›×¨×§×¢ / ×©×›×‘×ª ×¢×œ */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.2; /* ×©×§×™×¤×•×ª ×œ×¨×§×¢ */
            z-index: 0; /* ××ª×—×ª ×œ×˜×§×¡×˜ */
            filter: grayscale(50%); /* ×’×•×•×Ÿ ×¢×“×™×Ÿ */
        }
        .phrase-button .text-content {
            position: relative;
            z-index: 1; /* ××¢×œ ×”××™××•×’'×™ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%; /* ×›×“×™ ×œ××¨×›×– ××ª ×”×˜×§×¡×˜ */
            padding: 5px; /* ×¤×“×™× ×’ ×§×˜×Ÿ ×›×“×™ ×©×œ× ×™×™×’×¢ ×‘×’×‘×•×œ×•×ª */
        }


        .phrase-button.urgent {
            @apply bg-red-400 text-white;
            border-color: rgba(255, 0, 0, 0.6);
            animation: urgent-pulse 1s infinite alternate;
        }

        .phrase-button:not(.urgent):hover {
            background-color: rgba(240, 240, 240, 0.9);
            border-color: rgba(0, 123, 255, 0.5);
        }

        /* ×¢×™×¦×•×‘ ×›×¤×ª×•×¨×™× ×©×œ ×ª×¨×’×•× ××™×™×“×™ */
        .instant-phrase-button {
            @apply px-6 py-3 bg-indigo-500 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-600 transition-all text-xl;
            white-space: nowrap; /* ×œ×× ×•×¢ ×©×‘×™×¨×ª ×©×•×¨×•×ª */
        }
        .instant-phrase-button.thai {
            @apply thai-text;
        }

        /* ×¢×™×¦×•×‘ ×›×¤×ª×•×¨×™ ××¡×¤×¨×™× */
        .number-button {
            @apply px-4 py-2 bg-yellow-400 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-yellow-500 transition-all text-2xl;
        }
        .number-button.thai {
            @apply thai-text;
        }

        /* ×¤×•×¤××¤: ×¡×’× ×•×Ÿ ×˜×§×¡×˜ ×‘×ª×•×š ×”×¤×•×¤××¤ */
        #popupText .hebrew-text {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        #popupText .thai-text-popup { /* ×§×œ××¡ × ×¤×¨×“ ×œ×˜×§×¡×˜ ×ª××™×ª ×‘×¤×•×¤××¤ */
            font-family: 'Noto Sans Thai', sans-serif;
            font-size: 2.2rem;
            color: #4a5568; /* ×¦×‘×¢ ×›×”×” ×™×•×ª×¨ */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-white min-h-screen flex flex-col items-center p-6 space-y-8">

    <!-- ××¡×š ×ª×¨×’×•× ×¨××©×™ ×“×™× ××™ -->
    <div id="mainTranslationDisplay" class="w-full max-w-4xl glass-panel">
        <span id="mainDisplayText">×”×§×œ×“ ××©×”×• ××• ×‘×—×¨ ××©×¤×˜...</span>
    </div>

    <div class="w-full max-w-7xl flex flex-wrap lg:flex-nowrap justify-center gap-8">
        <!-- ×¤×× ×œ ×¢×•×‘×“ ×ª××™×œ× ×“×™ - ×‘×§×©×•×ª ×œ×× ×”×œ -->
        <div class="glass-panel p-8 flex-1 flex flex-col items-center min-w-[320px] sm:min-w-[45%] lg:min-w-[45%] bg-green-50/50">
            <h2 class="text-3xl font-bold text-green-700 mb-6">×¢×•×‘×“ ×ª××™×œ× ×“×™ (×‘×§×©×•×ª ×œ×× ×”×œ)</h2>
            <div id="thaiWorkerPanel" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 w-full">
                <!-- ×›×¤×ª×•×¨×™× ×™×™×•×•×¦×¨×• ×›××Ÿ ×‘××•×¤×Ÿ ×“×™× ××™ ×‘×××¦×¢×•×ª JavaScript -->
            </div>
        </div>

        <!-- ×¤×× ×œ ×× ×”×œ - ×”×•×¨××•×ª ×œ×¢×•×‘×“ -->
        <div class="glass-panel p-8 flex-1 flex flex-col items-center min-w-[320px] sm:min-w-[45%] lg:min-w-[45%] bg-blue-50/50">
            <h2 class="text-3xl font-bold text-blue-700 mb-6">×× ×”×œ (×”×•×¨××•×ª ×œ×¢×•×‘×“)</h2>
            <div id="managerPanel" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 w-full">
                <!-- ×›×¤×ª×•×¨×™× ×™×™×•×•×¦×¨×• ×›××Ÿ ×‘××•×¤×Ÿ ×“×™× ××™ ×‘×××¦×¢×•×ª JavaScript -->
            </div>
        </div>
    </div>

    <!-- ×¤×× ×œ ××©×¤×˜×™ ×ª×¨×’×•× ××™×™×“×™ -->
    <div class="glass-panel p-8 w-full max-w-7xl flex flex-col items-center">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">××©×¤×˜×™ ×ª×¨×’×•× ××™×™×“×™</h2>
        <div class="flex flex-wrap justify-center gap-4 mb-8 w-full">
            <!-- ×›×¤×ª×•×¨×™× ×œ××©×¤×˜×™× ×‘×¢×‘×¨×™×ª -->
            <div class="flex flex-col items-center w-full md:w-1/2 lg:w-2/5">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">×¢×‘×¨×™×ª ×œ×ª××™×ª</h3>
                <div id="instantPhrasesHe" class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
                    <!-- ×›×¤×ª×•×¨×™ ××©×¤×˜×™× ×™×™×•×•×¦×¨×• ×›××Ÿ -->
                </div>
            </div>
            <!-- ×›×¤×ª×•×¨×™× ×œ××©×¤×˜×™× ×‘×ª××™×ª -->
            <div class="flex flex-col items-center w-full md:w-1/2 lg:w-2/5">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">×ª××™×ª ×œ×¢×‘×¨×™×ª</h3>
                <div id="instantPhrasesTh" class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
                    <!-- ×›×¤×ª×•×¨×™ ××©×¤×˜×™× ×™×™×•×•×¦×¨×• ×›××Ÿ -->
                </div>
            </div>
              <!-- ×›×¤×ª×•×¨×™ ××¡×¤×¨×™× 1-10 ×‘×¢×‘×¨×™×ª -->
            <div class="flex flex-col items-center w-full md:w-1/2 lg:w-2/5 mt-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">××¡×¤×¨×™× (×¢×‘×¨×™×ª ×œ×ª××™×ª)</h3>
                <div id="numberPhrasesHe" class="grid grid-cols-2 sm:grid-cols-3 gap-4 w-full">
                    <!-- ×›×¤×ª×•×¨×™ ××¡×¤×¨×™× ×™×™×•×•×¦×¨×• ×›××Ÿ -->
                </div>
            </div>
            <!-- ×›×¤×ª×•×¨×™ ××¡×¤×¨×™× 1-10 ×‘×ª××™×ª -->
            <div class="flex flex-col items-center w-full md:w-1/2 lg:w-2/5 mt-8">
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">à¸•à¸±à¸§à¹€à¸¥à¸‚ (×ª××™×ª ×œ×¢×‘×¨×™×ª)</h3>
                <div id="numberPhrasesTh" class="grid grid-cols-2 sm:grid-cols-3 gap-4 w-full">
                    <!-- ×›×¤×ª×•×¨×™ ××¡×¤×¨×™× ×™×™×•×•×¦×¨×• ×›××Ÿ -->
                </div>
            </div>
        </div>
        <!-- ××–×•×¨ ×œ×”×¦×’×ª ×”××©×¤×˜ ×”××ª×•×¨×’× ×”××™×™×“×™ - × ×©××¨ ×¢×‘×•×¨ ×ª×¨×’×•× ××”×™×¨ ×©×œ ×›×¤×ª×•×¨×™× ××œ×• -->
        <div id="instantTranslationOutput" class="mt-8 p-6 text-2xl font-bold text-gray-900 bg-gray-50 rounded-2xl border-4 border-transparent min-h-[100px] flex items-center justify-center w-full max-w-2xl text-center shadow-lg transition-all duration-300">
            ×”××©×¤×˜ ×”××ª×•×¨×’× ×™×•×¤×™×¢ ×›××Ÿ (×ª×¨×’×•× ××™×™×“×™ ××›×¤×ª×•×¨×™×).
        </div>
    </div>

    <!-- ×¤×× ×œ ×ª×¨×’×•× ×•×›×ª×™×‘×” ×—×•×¤×©×™×ª -->
    <div class="glass-panel p-8 w-full max-w-7xl flex flex-col items-center">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">×ª×¨×’×•× ×•×›×ª×™×‘×” ×—×•×¤×©×™×ª</h2>
        <textarea id="freeTextInput" placeholder="×”×§×œ×“ ×›××Ÿ ×˜×§×¡×˜ ×‘×¢×‘×¨×™×ª ××• ×‘×ª××™×ª..." rows="4"
                    class="w-full p-4 mb-6 text-xl border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 transition-all resize-y shadow-sm"></textarea>
        <div class="flex flex-wrap justify-center gap-4 mb-8 w-full">
            <button id="setLangHe" class="px-8 py-4 bg-gray-600 text-white font-semibold rounded-lg shadow-md hover:bg-gray-700 transition-all text-xl">
                ×”×§×œ×“ ×‘×¢×‘×¨×™×ª
            </button>
            <button id="setLangTh" class="px-8 py-4 bg-gray-600 text-white font-semibold rounded-lg shadow-md hover:bg-gray-700 transition-all text-xl thai-text">
                à¸à¸´à¸¡à¸à¹Œà¸ à¸²à¸©à¸²à¹„à¸—à¸¢
            </button>
            <button id="speakTranslated" class="px-8 py-4 bg-red-600 text-white font-semibold rounded-lg shadow-md hover:bg-red-700 transition-all text-xl">
                ×”×©××¢ ×˜×§×¡×˜ ××ª×•×¨×’×
            </button>
        </div>
        <div class="simple-keyboard w-full"></div>
    </div>

    <!-- ×—×œ×•×Ÿ ×¤×•×¤××¤ (Popup) - ×©×›×‘×ª ×¢×œ × ×¡×ª×¨×ª ×©×ª×•×¤×™×¢ ×‘×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ -->
    <div id="popupOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div id="popupContent" class="glass-panel p-10 flex flex-col items-center justify-center max-w-lg w-11/12 transform scale-0 opacity-0 transition-all duration-300 ease-out relative">
            <span id="popupEmoji" class="absolute top-4 left-4 text-5xl hidden"></span>
            <div id="popupText" class="text-4xl font-bold text-center mb-8 text-gray-800"></div>
            <button id="popupReplayButton" class="px-8 py-4 bg-purple-600 text-white font-semibold rounded-full shadow-lg hover:bg-purple-700 transition-all duration-200 text-2xl">
                ğŸ”Š ×”×©××¢ ×©×•×‘
            </button>
            <button id="popupCloseButton" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-3xl font-bold">
                &times;
            </button>
        </div>
    </div>

    <!-- ××œ×× ×˜ ××•×“×™×• ×œ×¦×œ×™×œ ×¤×¢××•×Ÿ - ×¦×œ×™×œ ×§×¦×¨ ×•×—×–×§ ×œ×œ×—×™×¦×” -->
    <audio id="bellSound" src="data:audio/mpeg;base64,TBD_BELL_SOUND_BASE64_AUDIO_HERE"></audio>

    <!-- simple-keyboard JS CDN - ×¢×‘×•×¨ ×”××§×œ×“×ª ×”×•×•×™×¨×˜×•××œ×™×ª -->
    <script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>

    <script>
        // Note: The SERVER_URL has been removed as translation is now handled directly via the Gemini API.
        // For static phrase audio files, you MUST populate the Base64 values with your actual audio files.

        let currentAudio = null; // Variable to hold the current audio player instance

        // HTML element references for the popup
        const popupOverlay = document.getElementById('popupOverlay');
        const popupContent = document.getElementById('popupContent');
        const popupText = document.getElementById('popupText');
        const popupReplayButton = document.getElementById('popupReplayButton');
        const popupCloseButton = document.getElementById('popupCloseButton');
        const popupEmoji = document.getElementById('popupEmoji'); // Emoji icon for the popup
        let popupAudioUrl = ''; // Stores the audio URL played in the popup
        let popupCloseTimeout; // Variable to hold the timeout for automatic popup closing

        // HTML element references for instant translation and main display
        const instantTranslationOutput = document.getElementById('instantTranslationOutput');
        const mainTranslationDisplay = document.getElementById('mainTranslationDisplay');
        const mainDisplayText = document.getElementById('mainDisplayText');
        const freeTextInput = document.getElementById('freeTextInput');

        // Bell sound element
        const bellSound = document.getElementById('bellSound');

        // SimpleKeyboard virtual keyboard settings
        let keyboard;
        let currentKeyboardLayout = 'hebrew'; // Default layout: Hebrew

        // Keyboard layouts for Hebrew and Thai (basic examples)
        const layoutOptions = {
            'hebrew': {
                default: [
                    "` 1 2 3 4 5 6 7 8 9 0 - = {bksp}",
                    "{tab} / ' ×§ ×¨ ×• ×Ÿ ×˜ ×¦ ×© ×“ ×’ ×› ×¢ ×— ×™ ×œ ×£ ,",
                    "{capslock} ×– ×¡ ×‘ ×” ×  × ×š ×£ , . / \\",
                    "{shift} ×ª × ×“ ×” ×‘ ×’ ×• ×— ×– ×œ ×˜ ×¨ ×  × {shift}",
                    "{space}"
                ],
                shift: [
                    "~ ! @ # $ % ^ & * ( ) _ + {bksp}",
                    "{tab} Q W E R T Y U I O P { } |",
                    "{capslock} A S D F G H J K L : \"",
                    "{shift} Z X C V B N M < > ? {shift}",
                    "{space}"
                ]
            },
            'thai': {
                default: [
                    "à¹… / - à¸  à¸–à¸¸ à¸¹ à¸à¸¶ à¸«à¸´ à¹ˆ à¹‰ à¹‡ à¸· {bksp}",
                    "{tab} à¸à¸± à¸£à¸™ à¸° à¸•à¸£ à¸¢à¸š à¸¸à¸¢ à¸­à¸´ à¹‚ à¹‚à¸­ à¸› à¸ à¸¬",
                    "{capslock} à¸² à¸ª à¸” à¸Ÿ à¹ à¸°à¸± à¸« à¹‚ à¸„ à¸Š",
                    "{shift} à¸‹à¸© à¸¡à¸­ à¸”à¸š à¸™ à¹€ à¸— à¸ˆ à¸ à¹‡ {shift}",
                    "{space}"
                ]
            }
        };

        // Base64 audio data storage
        // IMPORTANT: These are dummy files. You MUST replace the Base64 values with your actual audio files.
        // You can use online tools or scripts to convert MP3/WAV files to Base64.
        const base64AudioData = {
            "bell_sound": "data:audio/mpeg;base64,", // Changed from TBD_BELL_SOUND_BASE64_AUDIO_HERE
            "he_break_1": "data:audio/mpeg;base64,",
            "th_break_1": "data:audio/mpeg;base64,",
            "he_toilet_1": "data:audio/mpeg;base64,",
            "th_toilet_1": "data:audio/mpeg;base64,",
            "he_help_1": "data:audio/mpeg;base64,",
            "th_help_1": "data:audio/mpeg;base64,",
            "he_sick_1": "data:audio/mpeg;base64,",
            "th_sick_1": "data:audio/mpeg;base64,",
            "he_load_cement_1": "data:audio/mpeg;base64,",
            "th_load_cement_1": "data:audio/mpeg;base64,",
            "he_load_bags_1": "data:audio/mpeg;base64,",
            "th_load_bags_1": "data:audio/mpeg;base64,",
            "he_help_alaa_1": "data:audio/mpeg;base64,",
            "th_help_alaa_1": "data:audio/mpeg;base64,",
            "he_help_adham_1": "data:audio/mpeg;base64,",
            "th_help_adham_1": "data:audio/mpeg;base64,",
            "he_help_store_1": "data:audio/mpeg;base64,",
            "th_help_store_1": "data:audio/mpeg;base64,",
            "he_next_product_1": "data:audio/mpeg;base64,",
            "th_next_product_1": "data:audio/mpeg;base64,",
            "he_good_morning_1": "data:audio/mpeg;base64,",
            "th_good_morning_1": "data:audio/mpeg;base64,",
            "he_good_evening_1": "data:audio/mpeg;base64,",
            "th_good_evening_1": "data:audio/mpeg;base64,",
            "he_how_are_you_1": "data:audio/mpeg;base64,",
            "th_how_are_you_1": "data:audio/mpeg;base64,",
            "he_how_do_you_feel_1": "data:audio/mpeg;base64,",
            "th_how_do_you_feel_1": "data:audio/mpeg;base64,",
            "he_come_help_loading_1": "data:audio/mpeg;base64,",
            "th_come_help_loading_1": "data:audio/mpeg;base64,",
            "he_need_forklift_1": "data:audio/mpeg;base64,",
            "th_need_forklift_1": "data:audio/mpeg;base64,",
            "he_where_is_it_1": "data:audio/mpeg;base64,",
            "th_where_is_it_1": "data:audio/mpeg;base64,",
            "he_finished_work_1": "data:audio/mpeg;base64,",
            "th_finished_work_1": "data:audio/mpeg;base64,",
            "he_need_water_1": "data:audio/mpeg;base64,",
            "th_need_water_1": "data:audio/mpeg;base64,",
            "he_hungry_1": "data:audio/mpeg;base64,",
            "th_hungry_1": "data:audio/mpeg;base64,",
            "he_thank_you_1": "data:audio/mpeg;base64,",
            "th_thank_you_1": "data:audio/mpeg;base64,",
            "he_you_are_welcome_1": "data:audio/mpeg;base64,",
            "th_you_are_welcome_1": "data:audio/mpeg;base64,",
            "he_please_1": "data:audio/mpeg;base64,",
            "th_please_1": "data:audio/mpeg;base64,",
            "he_yes_1": "data:audio/mpeg;base64,",
            "th_yes_1": "data:audio/mpeg;base64,",
            "he_no_1": "data:audio/mpeg;base64,",
            "th_no_1": "data:audio/mpeg;base64,",
            "he_come_back_tomorrow_1": "data:audio/mpeg;base64,",
            "th_come_back_tomorrow_1": "data:audio/mpeg;base64,",
            "he_work_harder_1": "data:audio/mpeg;base64,",
            "th_work_harder_1": "data:audio/mpeg;base64,",
            "he_take_a_break_1": "data:audio/mpeg;base64,",
            "th_take_a_break_1": "data:audio/mpeg;base64,",
            "he_good_job_1": "data:audio/mpeg;base64,",
            "th_good_job_1": "data:audio/mpeg;base64,",
            "he_clean_this_1": "data:audio/mpeg;base64,",
            "th_clean_this_1": "data:audio/mpeg;base64,",
            "he_move_it_there_1": "data:audio/mpeg;base64,",
            "th_move_it_there_1": "data:audio/mpeg;base64,",
            "he_finish_loading_1": "data:audio/mpeg;base64,",
            "th_finish_loading_1": "data:audio/mpeg;base64,",
            "he_go_to_lunch_1": "data:audio/mpeg;base64,",
            "th_go_to_lunch_1": "data:audio/mpeg;base64,",
            "he_number_1": "data:audio/mpeg;base64,",
            "th_number_1": "data:audio/mpeg;base64,",
            "he_number_2": "data:audio/mpeg;base64,",
            "th_number_2": "data:audio/mpeg;base64,", /* FIXED: Changed base664 to base64 */
            "he_number_3": "data:audio/mpeg;base64,",
            "th_number_3": "data:audio/mpeg;base64,",
            "he_number_4": "data:audio/mpeg;base64,",
            "th_number_4": "data:audio/mpeg;base64,",
            "he_number_5": "data:audio/mpeg;base64,",
            "th_number_5": "data:audio/mpeg;base64,",
            "he_number_6": "data:audio/mpeg;base64,",
            "th_number_6": "data:audio/mpeg;base64,",
            "he_number_7": "data:audio/mpeg;base64,",
            "th_number_7": "data:audio/mpeg;base64,",
            "he_number_8": "data:audio/mpeg;base64,",
            "th_number_8": "data:audio/mpeg;base64,",
            "he_number_9": "data:audio/mpeg;base64,",
            "th_number_9": "data:audio/mpeg;base64,",
            "he_number_10": "data:audio/mpeg;base64,",
            "th_number_10": "data:audio/mpeg;base64,",
            "he_wait_a_minute": "data:audio/mpeg;base64,",
            "th_wait_a_minute": "data:audio/mpeg;base64,",
            "he_clean_floor": "data:audio/mpeg;base64,",
            "th_clean_floor": "data:audio/mpeg;base64,",
            "he_come_here_now": "data:audio/mpeg;base64,",
            "th_come_here_now": "data:audio/mpeg;base64,",
            "he_start_working": "data:audio/mpeg;base64,",
            "th_start_working": "data:audio/mpeg;base64,",
            "he_customer_is_waiting": "data:audio/mpeg;base64,",
            "th_customer_is_waiting": "data:audio/mpeg;base64,",
            "he_where_is_cement_1": "data:audio/mpeg;base64,",
            "th_where_is_cement_1": "data:audio/mpeg;base64,",
            "he_finished_loading_1": "data:audio/mpeg;base64,",
            "th_finished_loading_1": "data:audio/mpeg;base64,",
            "he_need_more_bags_1": "data:audio/mpeg;base64,",
            "th_need_more_bags_1": "data:audio/mpeg;base64,",
            "he_customer_waiting_1": "data:audio/mpeg;base64,",
            "th_customer_waiting_1": "data:audio/mpeg;base64,",
            "he_arrange_shelves": "data:audio/mpeg;base64,",
            "th_arrange_shelves": "data:audio/mpeg;base64,",
            "he_unload_truck": "data:audio/mpeg;base64,",
            "th_unload_truck": "data:audio/mpeg;base64,",
            "he_wear_safety_gear": "data:audio/mpeg;base64,",
            "th_wear_safety_gear": "data:audio/mpeg;base64,",
            "he_organize_area_1": "data:audio/mpeg;base64,",
            "th_organize_area_1": "data:audio/mpeg;base64,",
            "he_clean_table_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
            "th_clean_table_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
            "he_finish_now_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
            "th_finish_now_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
            "he_come_here_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
            "th_come_here_1": "data:audio/mpeg;base64,", /* Added missing audio IDs */
        };


        // ×××’×¨ ×”××©×¤×˜×™× ×”×¨××©×™ ×¢×‘×•×¨ ×›×¤×ª×•×¨×™ ×”×¤×× ×œ×™×
        const phrasesData = [
            // ×‘×§×©×•×ª ×¢×•×‘×“ ×ª××™×œ× ×“×™ (×‘×§×©×•×ª ×œ×× ×”×œ)
            { "id": "thai_break_request_1", "display_text": "×”×¤×¡×§×”", "icon": "â˜•", "he_text": "×× ×™ ×¨×•×¦×” ×”×¤×¡×§×”.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸‚à¸­à¸à¸±à¸", "he_audio_id": "he_break_1", "th_audio_id": "th_break_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_toilet_request_1", "display_text": "×©×™×¨×•×ª×™×", "icon": "ğŸš½", "he_text": "×× ×™ ×¦×¨×™×š ×œ×©×™×¨×•×ª×™×.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹„à¸›à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³", "he_audio_id": "he_toilet_1", "th_audio_id": "th_toilet_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_help_request_1", "display_text": "×¢×–×¨×” ×“×—×•×£", "icon": "âœ‹", "he_text": "×× ×™ ×¦×¨×™×š ×¢×–×¨×” ×¢×›×©×™×•!", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¹€à¸”à¸µà¹‹à¸¢à¸§à¸™à¸µà¹‰!", "he_audio_id": "he_help_1", "th_audio_id": "th_help_1", "panel": "thai_worker", "is_urgent": true },
            { "id": "thai_sick_request_1", "display_text": "××¨×’×™×© ×—×•×œ×”", "icon": "ğŸ˜·", "he_text": "×× ×™ ××¨×’×™×© ×—×•×œ×”.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹„à¸¡à¹ˆà¸ªà¸šà¸²à¸¢", "he_audio_id": "he_sick_1", "th_audio_id": "th_sick_1", "panel": "thai_worker", "is_urgent": true },
            { "id": "thai_good_morning_1", "display_text": "×‘×•×§×¨ ×˜×•×‘", "icon": "â˜€ï¸", "he_text": "×‘×•×§×¨ ×˜×•×‘.", "th_text": "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸Šà¹‰à¸²", "he_audio_id": "he_good_morning_1", "th_audio_id": "th_good_morning_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_good_evening_1", "display_text": "×¢×¨×‘ ×˜×•×‘", "icon": "ğŸŒ™", "he_text": "×¢×¨×‘ ×˜×•×‘.", "th_text": "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸¢à¹‡à¸™", "he_audio_id": "he_good_evening_1", "th_audio_id": "th_good_evening_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_how_are_you_1", "display_text": "××” ×©×œ×•××š?", "icon": "ğŸ˜Š", "he_text": "××” ×©×œ×•××š?", "th_text": "à¸ªà¸šà¸²à¸¢à¸”à¸µà¹„à¸«à¸¡?", "he_audio_id": "he_how_are_you_1", "th_audio_id": "th_how_are_you_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_how_do_you_feel_1", "display_text": "××™×š ××¨×’×™×©?", "icon": "ğŸ¤’", "he_text": "××™×š ××ª×” ××¨×’×™×©?", "th_text": "à¸„à¸¸à¸“à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?", "he_audio_id": "he_how_do_you_feel_1", "th_audio_id": "th_how_do_you_feel_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_need_forklift_1", "display_text": "×¦×¨×™×š ××œ×’×–×”", "icon": "ğŸšš", "he_text": "×× ×™ ×¦×¨×™×š ××œ×’×–×”.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸£à¸–à¸¢à¸", "he_audio_id": "he_need_forklift_1", "th_audio_id": "th_need_forklift_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_where_is_it_1", "display_text": "××™×¤×” ×–×”?", "icon": "â“", "he_text": "××™×¤×” ×–×”?", "th_text": "à¸¡à¸±à¸™à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?", "he_audio_id": "he_where_is_it_1", "th_audio_id": "th_where_is_it_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_finished_work_1", "display_text": "×¡×™×™××ª×™ ×¢×‘×•×“×”", "icon": "âœ…", "he_text": "×¡×™×™××ª×™ ××ª ×”×¢×‘×•×“×”.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸—à¸³à¸‡à¸²à¸™à¹€à¸ªà¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§", "he_audio_id": "he_finished_work_1", "th_audio_id": "th_finished_work_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_need_water_1", "display_text": "×¦×¨×™×š ××™×", "icon": "ğŸ’§", "he_text": "×× ×™ ×¦×¨×™×š ××™×.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸™à¹‰à¸³", "he_audio_id": "he_need_water_1", "th_audio_id": "th_need_water_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_hungry_1", "display_text": "×× ×™ ×¨×¢×‘", "icon": "ğŸ”", "he_text": "×× ×™ ×¨×¢×‘.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸«à¸´à¸§", "he_audio_id": "he_hungry_1", "th_audio_id": "th_hungry_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_thank_you_1", "display_text": "×ª×•×“×”", "icon": "ğŸ™", "he_text": "×ª×•×“×”.", "th_text": "à¸‚à¸­à¸šà¸„à¸¸à¸“", "he_audio_id": "he_thank_you_1", "th_audio_id": "th_thank_you_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_you_are_welcome_1", "display_text": "×‘×‘×§×©×”", "icon": "ğŸ˜Š", "he_text": "×‘×‘×§×©×”.", "th_text": "à¸¢à¸´à¸™à¸”à¸µ", "he_audio_id": "he_you_are_welcome_1", "th_audio_id": "th_you_are_welcome_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_yes_1", "display_text": "×›×Ÿ", "icon": "ğŸ‘", "he_text": "×›×Ÿ.", "th_text": "à¹ƒà¸Šà¹ˆ", "he_audio_id": "he_yes_1", "th_audio_id": "th_yes_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_no_1", "display_text": "×œ×", "icon": "ğŸ‘", "he_text": "×œ×.", "th_text": "à¹„à¸¡à¹ˆ", "he_audio_id": "he_no_1", "th_audio_id": "th_no_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_where_is_cement_1", "display_text": "××™×¤×” ×”××œ×˜?", "icon": "ğŸ§±", "he_text": "××™×¤×” ×”××œ×˜?", "th_text": "à¸›à¸¹à¸™à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?", "he_audio_id": "he_where_is_cement_1", "th_audio_id": "th_where_is_cement_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_finished_loading_1", "display_text": "×¡×™×™××ª×™ ×”×¢××¡×”", "icon": "ğŸ“¦", "he_text": "×¡×™×™××ª×™ ×œ×”×¢××™×¡.", "th_text": "à¸‚à¸™à¸‚à¸­à¸‡à¹€à¸ªà¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§", "he_audio_id": "he_finished_loading_1", "th_audio_id": "th_finished_loading_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_need_more_bags_1", "display_text": "×¦×¨×™×š ×¢×•×“ ×©×§×™×", "icon": "ğŸ›ï¸", "he_text": "×× ×™ ×¦×¨×™×š ×¢×•×“ ×©×§×™×.", "th_text": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸–à¸¸à¸‡à¹€à¸à¸´à¹ˆà¸¡", "he_audio_id": "he_need_more_bags_1", "th_audio_id": "th_need_more_bags_1", "panel": "thai_worker", "is_urgent": false },
            { "id": "thai_customer_waiting_1", "display_text": "×œ×§×•×— ××—×›×”", "icon": "ğŸš¶", "he_text": "×œ×§×•×— ××—×›×”.", "th_text": "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸à¸³à¸¥à¸±à¸‡à¸£à¸­", "he_audio_id": "he_customer_waiting_1", "th_audio_id": "th_customer_waiting_1", "panel": "thai_worker", "is_urgent": true },

            // ×”×•×¨××•×ª ×× ×”×œ (×”×•×¨××•×ª ×œ×¢×•×‘×“)
            { "id": "manager_load_cement_1", "display_text": "×”×¢××¡ ××œ×˜", "icon": "ğŸ—ï¸", "he_text": "×ª×¢××™×¡ ××œ×˜.", "th_text": "à¸‚à¸™à¸›à¸¹à¸™", "he_audio_id": "he_load_cement_1", "th_audio_id": "th_load_cement_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_organize_area_1", "display_text": "×¡×“×¨ ××–×•×¨", "icon": "ğŸ§¹", "he_text": "×ª×‘×•× ×ª×¡×“×¨ ××ª ×”××–×•×¨ ×”×–×”.", "th_text": "à¸¡à¸²à¸ˆà¸±à¸”à¸£à¸°à¹€à¸šà¸µà¸¢à¸šà¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸™à¸µà¹‰à¸«à¸™à¹ˆà¸­à¸¢", "he_audio_id": "he_organize_area_1", "th_audio_id": "th_organize_area_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_clean_table_1", "display_text": "× ×§×” ×©×•×œ×—×Ÿ", "icon": "ğŸ§¼", "he_text": "×ª× ×§×” ××ª ×”×©×•×œ×—×Ÿ.", "th_text": "à¸—à¸³à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¹‚à¸•à¹Šà¸°", "he_audio_id": "he_clean_table_1", "th_audio_id": "th_clean_table_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_finish_now_1", "display_text": "×¡×™×™× ×¢×›×©×™×•", "icon": "â±ï¸", "he_text": "×ª×¡×™×™× ××ª ×”×¢×‘×•×“×” ×¢×›×©×™×•.", "th_text": "à¸—à¸³à¸‡à¸²à¸™à¹ƒà¸«à¹‰à¹€à¸ªà¸£à¹‡à¸ˆà¹€à¸”à¸µà¹‹à¸¢à¸§à¸™à¸µà¹‰", "he_audio_id": "he_finish_now_1", "th_audio_id": "th_finish_now_1", "panel": "manager", "is_urgent": true },
            { "id": "manager_come_here_1", "display_text": "×‘×•× ×œ×›××Ÿ", "icon": "ğŸš¶â€â™‚ï¸", "he_text": "×‘×•× ×œ×›××Ÿ ×‘×‘×§×©×”.", "th_text": "à¸¡à¸²à¸™à¸µà¹ˆà¸«à¸™à¹ˆà¸­à¸¢à¸„à¸£à¸±à¸š/à¸„à¹ˆà¸°", "he_audio_id": "he_come_here_1", "th_audio_id": "th_come_here_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_load_bags_1", "display_text": "×”×¢××¡ ×©×§×™×", "icon": "ğŸ›ï¸", "he_text": "×ª×¢××™×¡ ××ª ×”×©×§×™×.", "th_text": "à¸‚à¸™à¸à¸£à¸°à¸ªà¸­à¸š", "he_audio_id": "he_load_bags_1", "th_audio_id": "th_load_bags_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_help_alaa_1", "display_text": "×¢×–×•×¨ ×œ×¢×œ××", "icon": "ğŸ¤", "he_text": "×ª×¢×–×•×¨ ×œ×¢×œ××.", "th_text": "à¸Šà¹ˆà¸§à¸¢à¸­à¸°à¸¥à¸²à¸­à¹Œà¸«à¸™à¹ˆà¸­à¸¢", "he_audio_id": "he_help_alaa_1", "th_audio_id": "th_help_alaa_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_help_adham_1", "display_text": "×¢×–×•×¨ ×œ××“×”×", "icon": "ğŸ¤", "he_text": "×ª×¢×–×•×¨ ×œ××“×”×.", "th_text": "à¸Šà¹ˆà¸§à¸¢à¸­à¸²à¸”à¸²à¸¡à¸«à¸™à¹ˆà¸­à¸¢", "he_audio_id": "he_help_adham_1", "th_audio_id": "th_help_adham_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_help_store_1", "display_text": "×¢×–×•×¨ ×œ××—×¡×Ÿ", "icon": "ğŸ›’", "he_text": "×ª×¢×–×•×¨ ×œ××—×¡×Ÿ.", "th_text": "à¸Šà¹ˆà¸§à¸¢à¸„à¸¥à¸±à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸²à¸«à¸™à¹ˆà¸­à¸¢", "he_audio_id": "he_help_store_1", "th_audio_id": "th_help_store_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_next_product_1", "display_text": "××•×¦×¨ ×”×‘×", "icon": "â¡ï¸", "he_text": "×ª×‘×™× ××ª ×”××•×¦×¨ ×”×‘×.", "th_text": "à¹€à¸­à¸²à¸ªà¸´à¸™à¸„à¹‰à¸²à¸Šà¸´à¹‰à¸™à¸•à¹ˆà¸­à¹„à¸›à¸¡à¸²", "he_audio_id": "he_next_product_1", "th_audio_id": "th_next_product_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_come_help_loading_1", "display_text": "×‘×•× ×¢×–×•×¨ ×œ×”×¢××™×¡", "icon": "ğŸ’ª", "he_text": "×‘×•× ×ª×¢×–×•×¨ ×œ×”×¢××™×¡.", "th_text": "à¸¡à¸²à¸Šà¹ˆà¸§à¸¢à¸‚à¸™à¸‚à¸­à¸‡à¸«à¸™à¹ˆà¸­à¸¢", "he_audio_id": "he_come_help_loading_1", "th_audio_id": "th_come_help_loading_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_come_back_tomorrow_1", "display_text": "×ª×—×–×•×¨ ××—×¨", "icon": "ğŸ—“ï¸", "he_text": "×ª×—×–×•×¨ ××—×¨ ×œ×¢×‘×•×“×”.", "th_text": "à¸à¸¥à¸±à¸šà¸¡à¸²à¸—à¸³à¸‡à¸²à¸™à¸à¸£à¸¸à¹ˆà¸‡à¸™à¸µà¹‰", "he_audio_id": "he_come_back_tomorrow_1", "th_audio_id": "th_come_back_tomorrow_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_work_harder_1", "display_text": "×ª×¢×‘×•×“ ×™×•×ª×¨ ×—×–×§", "icon": "âš¡", "he_text": "×ª×¢×‘×•×“ ×™×•×ª×¨ ×—×–×§.", "th_text": "à¸—à¸³à¸‡à¸²à¸™à¹ƒà¸«à¹‰à¸«à¸™à¸±à¸à¸‚à¸¶à¹‰à¸™", "he_audio_id": "he_work_harder_1", "th_audio_id": "th_work_harder_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_take_a_break_1", "display_text": "×¦× ×œ×”×¤×¡×§×”", "icon": "â˜•", "he_text": "×¦× ×œ×”×¤×¡×§×”.", "th_text": "à¹„à¸›à¸à¸±à¸à¹„à¸”à¹‰", "he_audio_id": "he_take_a_break_1", "th_audio_id": "th_take_a_break_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_good_job_1", "display_text": "×¢×‘×•×“×” ×˜×•×‘×”", "icon": "â­", "he_text": "×¢×‘×•×“×” ×˜×•×‘×”!", "th_text": "à¸‡à¸²à¸™à¸”à¸µ", "he_audio_id": "he_good_job_1", "th_audio_id": "th_good_job_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_clean_this_1", "display_text": "× ×§×” ××ª ×–×”", "icon": "ğŸ§¼", "he_text": "×ª× ×§×” ××ª ×–×”.", "th_text": "à¸—à¸³à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¸­à¸±à¸™à¸™à¸µà¹‰", "he_audio_id": "he_clean_this_1", "th_audio_id": "th_clean_this_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_move_it_there_1", "display_text": "×”×–×– ×œ×©×", "icon": "ğŸšš", "he_text": "×ª×–×™×– ××ª ×–×” ×œ×©×.", "th_text": "à¸¢à¹‰à¸²à¸¢à¹„à¸›à¸•à¸£à¸‡à¸™à¸±à¹‰à¸™", "he_audio_id": "he_move_it_there_1", "th_audio_id": "th_move_it_there_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_finish_loading_1", "display_text": "×¡×™×™× ×œ×”×¢××™×¡", "icon": "âœ…", "he_text": "×ª×¡×™×™× ×œ×”×¢××™×¡.", "th_text": "à¸‚à¸™à¸‚à¸­à¸‡à¹€à¸ªà¸£à¹‡à¸ˆ", "he_audio_id": "he_finish_loading_1", "th_audio_id": "th_finish_loading_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_go_to_lunch_1", "display_text": "×œ×š ×œ××›×•×œ", "icon": "ğŸ²", "he_text": "×œ×š ×œ××›×•×œ ×¦×”×¨×™×™×.", "th_text": "à¹„à¸›à¸à¸´à¸™à¸‚à¹‰à¸²à¸§à¸à¸¥à¸²à¸‡à¸§à¸±à¸™", "he_audio_id": "he_go_to_lunch_1", "th_audio_id": "th_go_to_lunch_1", "panel": "manager", "is_urgent": false },
            { "id": "manager_wait_a_minute_1", "display_text": "×—×›×” ×“×§×”", "icon": "â³", "he_text": "×—×›×” ×“×§×”.", "th_text": "à¸£à¸­à¸ªà¸±à¸à¸„à¸£à¸¹à¹ˆ", "he_audio_id": "he_wait_a_minute", "th_audio_id": "th_wait_a_minute", "panel": "manager", "is_urgent": false },
            { "id": "manager_clean_floor_1", "display_text": "× ×§×” ×¨×¦×¤×”", "icon": "ğŸ§¹", "he_text": "×ª× ×§×” ××ª ×”×¨×¦×¤×”.", "th_text": "à¸—à¸³à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¸à¸·à¹‰à¸™", "he_audio_id": "he_clean_floor", "th_audio_id": "th_clean_floor", "panel": "manager", "is_urgent": false },
            { "id": "manager_come_here_now_1", "display_text": "×‘×•× ×œ×›××Ÿ ×¢×›×©×™×•", "icon": "ğŸš¨", "he_text": "×‘×•× ×œ×›××Ÿ ×¢×›×©×™×•!", "th_text": "à¸¡à¸²à¸™à¸µà¹ˆà¹€à¸”à¸µà¹‹à¸¢à¸§à¸™à¸µà¹‰!", "he_audio_id": "he_come_here_now", "th_audio_id": "th_come_here_now", "panel": "manager", "is_urgent": true },
            { "id": "manager_start_working_1", "display_text": "×ª×ª×—×™×œ ×œ×¢×‘×•×“", "icon": "â–¶ï¸", "he_text": "×ª×ª×—×™×œ ×œ×¢×‘×•×“.", "th_text": "à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸³à¸‡à¸²à¸™", "he_audio_id": "he_start_working", "th_audio_id": "th_start_working", "panel": "manager", "is_urgent": false },
            { "id": "manager_customer_is_waiting_1", "display_text": "×œ×§×•×— ××—×›×”", "icon": "ğŸ§", "he_text": "×œ×§×•×— ××—×›×”.", "th_text": "à¸¥à¸¹à¸à¸„à¹‰à¸²à¸£à¸­à¸­à¸¢à¸¹à¹ˆ", "he_audio_id": "he_customer_is_waiting", "th_audio_id": "th_customer_is_waiting", "panel": "manager", "is_urgent": false }
        ];

        // ×××’×¨ ×œ××©×¤×˜×™× ××™×™×“×™×™× ×•××¡×¤×¨×™×
        const instantPhrases = [
            { "text": "×‘×•×§×¨ ×˜×•×‘", "thai": "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸Šà¹‰à¸²", "he_audio_id": "he_good_morning_1", "th_audio_id": "th_good_morning_1" },
            { "text": "×¢×¨×‘ ×˜×•×‘", "thai": "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸¢à¹‡à¸™", "he_audio_id": "he_good_evening_1", "th_audio_id": "th_good_evening_1" },
            { "text": "××” ×©×œ×•××š?", "thai": "à¸ªà¸šà¸²à¸¢à¸”à¸µà¹„à¸«à¸¡?", "he_audio_id": "he_how_are_you_1", "th_audio_id": "th_how_are_you_1" },
            { "text": "××™×š ××ª×” ××¨×’×™×©?", "thai": "à¸„à¸¸à¸“à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?", "he_audio_id": "he_how_do_you_feel_1", "th_audio_id": "th_how_do_you_feel_1" },
            { "text": "×× ×™ ×¨×•×¦×” ×”×¤×¡×§×”.", "thai": "à¸œà¸¡/à¸‰à¸±à¸™ à¸‚à¸­à¸à¸±à¸", "he_audio_id": "he_break_1", "th_audio_id": "th_break_1" },
            { "text": "×× ×™ ×¦×¨×™×š ×œ×©×™×¨×•×ª×™×.", "thai": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹„à¸›à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³", "he_audio_id": "he_toilet_1", "th_audio_id": "th_toilet_1" },
            { "text": "×× ×™ ×¦×¨×™×š ×¢×–×¨×” ×¢×›×©×™×•!", "thai": "à¸œà¸¡/à¸‰à¸±à¸™ à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¹€à¸”à¸µà¹‹à¸¢à¸§à¸™à¸µà¹‰!", "he_audio_id": "he_help_1", "th_audio_id": "th_help_1" },
            { "text": "×× ×™ ××¨×’×™×© ×—×•×œ×”.", "thai": "à¸œà¸¡/à¸‰à¸±à¸™ à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹„à¸¡à¹ˆà¸ªà¸šà¸²à¸¢", "he_audio_id": "he_sick_1", "th_audio_id": "th_sick_1" },
            { "text": "×ª×•×“×”.", "thai": "à¸‚à¸­à¸šà¸„à¸¸à¸“", "he_audio_id": "he_thank_you_1", "th_audio_id": "th_thank_you_1" },
            { "text": "×‘×‘×§×©×”.", "thai": "à¸¢à¸´à¸™à¸”à¸µ", "he_audio_id": "he_you_are_welcome_1", "th_audio_id": "th_you_are_welcome_1" },
            { "text": "×›×Ÿ.", "thai": "à¹ƒà¸Šà¹ˆ", "he_audio_id": "he_yes_1", "th_audio_id": "th_yes_1" },
            { "text": "×œ×.", "thai": "à¹„à¸¡à¹ˆ", "he_audio_id": "he_no_1", "th_audio_id": "th_no_1" }
        ];

        const numberPhrases = [];
        for (let i = 1; i <= 10; i++) {
            numberPhrases.push({
                "text": i.toString(),
                "thai": getThaiNumber(i),
                "he_audio_id": `he_number_${i}`,
                "th_audio_id": `th_number_${i}`
            });
        }

        function getThaiNumber(num) {
            const thaiNumbers = ["", "à¸«à¸™à¸¶à¹ˆà¸‡", "à¸ªà¸­à¸‡", "à¸ªà¸²à¸¡", "à¸ªà¸µà¹ˆ", "à¸«à¹‰à¸²", "à¸«à¸", "à¹€à¸ˆà¹‡à¸”", "à¹à¸›à¸”", "à¹€à¸à¹‰à¸²", "à¸ªà¸´à¸š"];
            return thaiNumbers[num];
        }


        /**
         * ×× ×’×Ÿ ×¦×œ×™×œ ×¤×¢××•×Ÿ ×§×¦×¨.
         */
        function playBellSound() {
            if (bellSound) {
                bellSound.currentTime = 0; // ×”×ª×—×œ ××”×”×ª×—×œ×”
                bellSound.play().catch(e => console.error("×©×’×™××” ×‘× ×™×’×•×Ÿ ×¦×œ×¦×•×œ ×¤×¢××•×Ÿ:", e));
            }
        }

        /**
         * ××¦×™×’ ×¤×•×¤××¤ ×¢× ×˜×§×¡×˜ ×•××•×“×™×•.
         * @param {string} heText - ×”×˜×§×¡×˜ ×‘×¢×‘×¨×™×ª ×œ×”×¦×’×” ×‘×¤×•×¤××¤.
         * @param {string} thText - ×”×˜×§×¡×˜ ×‘×ª××™×ª ×œ×”×¦×’×” ×‘×¤×•×¤××¤.
         * @param {string} audioUrl - ×”-URL ×©×œ ×§×•×‘×¥ ×”××•×“×™×• ×œ× ×™×’×•×Ÿ.
         * @param {string} emoji - ×”××™××•×’'×™ ×œ×”×¦×’×” ×‘×¤×•×¤××¤.
         * @param {boolean} isUrgent - ×”×× ×”×”×•×“×¢×” ×“×—×•×¤×” (×ª×¤×¢×™×œ ×× ×™××¦×™×” ×•××™×™×§×•×Ÿ).
         */
        function showPopup(heText, thText, audioUrl, emoji, isUrgent = false) {
            clearTimeout(popupCloseTimeout); // × ×§×” ×›×œ ×˜×™×™××¨ ×§×•×“× ×©×œ ×¡×’×™×¨×” ××•×˜×•××˜×™×ª

            popupText.innerHTML = ''; // Clear previous content
            // Create spans for typing effect for both languages
            const hebrewSpan = document.createElement('span');
            hebrewSpan.classList.add('hebrew-text');
            hebrewSpan.dir = 'rtl';
            popupText.appendChild(hebrewSpan);

            const thaiSpan = document.createElement('span');
            thaiSpan.classList.add('thai-text-popup'); // Use specific class for popup Thai text
            thaiSpan.dir = 'ltr';
            popupText.appendChild(thaiSpan);

            // Display emoji in popup
            popupEmoji.textContent = emoji || '';
            popupEmoji.classList.toggle('hidden', !emoji);

            // Add/remove urgency animations
            popupContent.classList.remove('urgent-popup-animate', 'popup-animate');
            popupEmoji.classList.remove('emoji-sparkle-animate');

            if (isUrgent) {
                popupContent.classList.add('urgent-popup-animate');
                popupEmoji.classList.add('emoji-sparkle-animate');
                playBellSound(); // Play bell sound for urgent messages
            } else {
                popupContent.classList.add('popup-animate');
            }

            popupOverlay.classList.remove('hidden');
            // Trigger entry animation
            setTimeout(() => {
                popupContent.classList.remove('scale-0', 'opacity-0');
                popupContent.classList.add('scale-100', 'opacity-100');
            }, 10); // Short delay to ensure animation plays

            // Typing effect for Hebrew text first
            typingEffectForPopup(hebrewSpan, heText, 30, () => {
                // Then typing effect for Thai text
                typingEffectForPopup(thaiSpan, thText, 30);
            });

            // Play audio
            if (audioUrl) {
                playAudio(audioUrl);
            }

            // Close popup automatically after 2.5 seconds
            popupCloseTimeout = setTimeout(() => {
                hidePopup();
            }, 2500); // 2.5 seconds
        }

        /**
         * Helper for typing effect specifically for popup to avoid global typing effect class
         * @param {HTMLElement} element - The HTML element to apply typing effect to.
         * @param {string} text - The text to type.
         * @param {number} speed - Typing speed in milliseconds per character.
         * @param {function} callback - Callback function to execute after typing is complete.
         */
        function typingEffectForPopup(element, text, speed = 50, callback = () => {}) {
            let i = 0;
            element.textContent = ''; // Clear existing text
            // No blinking caret for popup spans, only for main display
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }


        /**
         * ××¡×ª×™×¨ ××ª ×”×¤×•×¤××¤.
         */
        function hidePopup() {
            clearTimeout(popupCloseTimeout); // × ×§×” ××ª ×”×˜×™×™××¨
            popupContent.classList.remove('scale-100', 'opacity-100');
            popupContent.classList.add('scale-0', 'opacity-0');
            // Remove animation classes after transition ends to allow re-triggering
            popupContent.addEventListener('transitionend', () => {
                popupOverlay.classList.add('hidden');
                popupEmoji.classList.remove('emoji-sparkle-animate');
                popupContent.classList.remove('urgent-popup-animate', 'popup-animate');
            }, { once: true });
        }

        /**
         * ×× ×’×Ÿ ×§×•×‘×¥ ××•×“×™×• ×-URL.
         * @param {string} audioUrl - ×”-URL ×©×œ ×§×•×‘×¥ ×”××•×“×™×•.
         */
        function playAudio(audioUrl) {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0; // Reset to start
            } else {
                currentAudio = new Audio();
            }
            currentAudio.src = audioUrl;
            currentAudio.play().catch(e => console.error("×©×’×™××” ×‘× ×™×’×•×Ÿ ××•×“×™×•:", e));
        }

        /**
         * ××¦×™×’ ×˜×§×¡×˜ ×‘××¤×§×˜ ×”×§×œ×“×” ×¢×œ ×”××¡×š ×”×¨××©×™.
         * @param {string} text - ×”×˜×§×¡×˜ ×œ×”×¦×’×”.
         * @param {string} lang - ×”×©×¤×” ×©×œ ×”×˜×§×¡×˜ ('he' ××• 'th').
         * @param {string} audioUrl - ×”-URL ×©×œ ×”××•×“×™×• ×œ× ×™×’×•×Ÿ.
         */
        function typeWriterEffect(text, lang, audioUrl) {
            mainDisplayText.textContent = ''; // × ×§×” ×˜×§×¡×˜ ×§×™×™×
            mainDisplayText.classList.remove('thai-text'); // ×”×¡×¨ ×¡×’× ×•×Ÿ ×ª××™×ª ×× ×§×™×™×
            mainDisplayText.classList.add('typing-effect'); // ×”×•×¡×£ ×¡××Ÿ ×”×§×œ×“×”

            if (lang === 'th') {
                mainDisplayText.classList.add('thai-text');
                mainDisplayText.style.direction = 'ltr'; // For Thai text, set direction to LTR
            } else {
                mainDisplayText.style.direction = 'rtl'; // For Hebrew text, set direction to RTL
            }

            let i = 0;
            const speed = 70; // ××”×™×¨×•×ª ×”×§×œ×“×” ×‘××™×œ×™×©× ×™×•×ª

            function type() {
                if (i < text.length) {
                    mainDisplayText.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    mainDisplayText.classList.remove('typing-effect'); // ×”×¡×¨ ×¡××Ÿ ×”×§×œ×“×” ×‘×¡×™×•×
                    // × ×’×Ÿ ××•×“×™×• ×¨×§ ×œ××—×¨ ×¡×™×•× ×”×§×œ×“×”
                    if (audioUrl) {
                        playAudio(audioUrl);
                    }
                }
            }
            type();
        }

        /**
         * ×¤×•× ×§×¦×™×” ×œ×™×¦×™×¨×ª ×›×¤×ª×•×¨ ×•×”×•×¡×¤×ª×• ×œ×¤×× ×œ.
         * @param {object} phrase - ××•×‘×™×™×§×˜ ×”××›×™×œ ××ª ×¤×¨×˜×™ ×”××©×¤×˜ (display_text, he_text, th_text, icon, he_audio_id, th_audio_id, is_urgent).
         * @param {HTMLElement} panelElement - ××œ×× ×˜ ×”-HTML (div) ×©××œ×™×• ×™×© ×œ×”×•×¡×™×£ ××ª ×”×›×¤×ª×•×¨.
         * @param {string} targetLangForMainDisplay - ×”×©×¤×” ×©×ª×•×¦×’ ×‘××¡×š ×”×¨××©×™ (he/th).
         */
        function createButton(phrase, panelElement, targetLangForMainDisplay) {
            const button = document.createElement('button');
            button.className = `p-4 flex flex-col items-center justify-center bg-white rounded-xl shadow-md hover:shadow-lg transition-all transform hover:scale-105
                                 text-xl font-semibold text-gray-800 border-2 border-transparent relative overflow-hidden h-32 text-center`; // ×”×’×“×œ ×’×•×‘×” ×”×›×¤×ª×•×¨×™×

            if (phrase.is_urgent) {
                button.classList.add('bg-red-500', 'text-white', 'hover:bg-red-600', 'border-red-700');
                const urgencyIndicator = document.createElement('span');
                urgencyIndicator.className = 'absolute top-2 left-2 text-3xl opacity-80';
                urgencyIndicator.textContent = 'â—'; // ××™×™×§×•×Ÿ ×“×—×™×¤×•×ª
                button.appendChild(urgencyIndicator);
            } else {
                button.classList.add('bg-blue-200', 'hover:bg-blue-300');
            }

            // ×”×•×¡×£ ××™××•×’'×™ ×›×¨×§×¢ ×¢×“×™×Ÿ
            if (phrase.icon) {
                const emojiBgSpan = document.createElement('span');
                emojiBgSpan.classList.add('emoji-background');
                emojiBgSpan.textContent = phrase.icon;
                button.appendChild(emojiBgSpan);
            }

            const textContent = document.createElement('span');
            textContent.classList.add('text-content');
            textContent.textContent = phrase.display_text;
            button.appendChild(textContent);

            // ×”×•×¡×£ ××™×¨×•×¢ ×œ×—×™×¦×” ×œ×›×¤×ª×•×¨
            button.addEventListener('click', () => {
                // Clear any previous main display content and its typing effect
                mainDisplayText.textContent = '';
                mainDisplayText.classList.remove('thai-text', 'typing-effect');
                mainTranslationDisplay.classList.remove('rainbow-border'); // Remove rainbow border on new click

                let textToSpeak = '';
                let audioIdToPlay = '';
                let popupHebrewText = '';
                let popupThaiText = '';

                // Determine what to display/speak based on the button's panel
                if (panelElement.id === 'thaiWorkerPanel') { // Thai worker's request (speaks Thai, translates to Hebrew)
                    textToSpeak = phrase.th_text;
                    audioIdToPlay = phrase.th_audio_id;
                    popupHebrewText = phrase.he_text;
                    popupThaiText = phrase.th_text;
                    typeWriterEffect(phrase.th_text, 'th', base64AudioData[phrase.th_audio_id]); // Display Thai in main display
                } else if (panelElement.id === 'managerPanel') { // Manager's instruction (speaks Hebrew, translates to Thai)
                    textToSpeak = phrase.he_text;
                    audioIdToPlay = phrase.he_audio_id;
                    popupHebrewText = phrase.he_text;
                    popupThaiText = phrase.th_text;
                    typeWriterEffect(phrase.he_text, 'he', base64AudioData[phrase.he_audio_id]); // Display Hebrew in main display
                } else if (panelElement.id === 'instantPhrasesHe' || panelElement.id === 'numberPhrasesHe') { // Hebrew instant phrases/numbers (speaks Hebrew, translates to Thai)
                    textToSpeak = phrase.he_text;
                    audioIdToPlay = phrase.he_audio_id;
                    popupHebrewText = phrase.he_text;
                    popupThaiText = phrase.th_text;
                    typeWriterEffect(phrase.he_text, 'he', base64AudioData[phrase.he_audio_id]); // Display Hebrew in main display
                } else if (panelElement.id === 'instantPhrasesTh' || panelElement.id === 'numberPhrasesTh') { // Thai instant phrases/numbers (speaks Thai, translates to Hebrew)
                    textToSpeak = phrase.th_text;
                    audioIdToPlay = phrase.th_audio_id;
                    popupHebrewText = phrase.he_text;
                    popupThaiText = phrase.th_text;
                    typeWriterEffect(phrase.th_text, 'th', base64AudioData[phrase.th_audio_id]); // Display Thai in main display
                }

                // Show the popup with both translated texts (Hebrew and Thai)
                showPopup(popupHebrewText, popupThaiText, base64AudioData[audioIdToPlay], phrase.icon, phrase.is_urgent);

                // Add rainbow border to main display while "translating" (typing effect is running)
                mainTranslationDisplay.classList.add('rainbow-border');
                // The rainbow border will be removed by typeWriterEffect callback.
            });

            panelElement.appendChild(button);
        }

        // ×¤×•× ×§×¦×™×•×ª ×œ××›×œ×•×¡ ×”×›×¤×ª×•×¨×™× ×‘×¤×× ×œ×™× ×”×©×•× ×™×
        function populatePanels() {
            const thaiWorkerPanel = document.getElementById('thaiWorkerPanel');
            const managerPanel = document.getElementById('managerPanel');
            const instantPhrasesHe = document.getElementById('instantPhrasesHe');
            const instantPhrasesTh = document.getElementById('instantPhrasesTh');
            const numberPhrasesHe = document.getElementById('numberPhrasesHe');
            const numberPhrasesTh = document.getElementById('numberPhrasesTh');


            phrasesData.forEach(phrase => {
                if (phrase.panel === 'thai_worker') {
                    createButton(phrase, thaiWorkerPanel, 'th'); // Thai worker speaks Thai, main display shows Thai
                } else if (phrase.panel === 'manager') {
                    createButton(phrase, managerPanel, 'he'); // Manager speaks Hebrew, main display shows Hebrew
                }
            });

            instantPhrrases.forEach(phrase => {
                createButton({
                    display_text: phrase.text,
                    icon: 'ğŸ’¬',
                    he_text: phrase.text,
                    th_text: phrase.thai,
                    he_audio_id: phrase.he_audio_id,
                    th_audio_id: phrase.th_audio_id,
                    is_urgent: false
                }, instantPhrasesHe, 'he'); // Instant Hebrew phrases, main display shows Hebrew
            });

            instantPhrases.forEach(phrase => {
                createButton({
                    display_text: phrase.thai, // Show Thai on button for Thai panel
                    icon: 'ğŸ’¬',
                    he_text: phrase.he_text,
                    th_text: phrase.thai,
                    he_audio_id: phrase.he_audio_id,
                    th_audio_id: phrase.th_audio_id,
                    is_urgent: false
                }, instantPhrasesTh, 'th'); // Instant Thai phrases, main display shows Thai
            });

            numberPhrases.forEach(phrase => {
                createButton({
                    display_text: phrase.text, // Show Arabic numeral on button
                    icon: '#ï¸âƒ£',
                    he_text: phrase.text,
                    th_text: phrase.thai,
                    he_audio_id: phrase.he_audio_id,
                    th_audio_id: phrase.th_audio_id,
                    is_urgent: false
                }, numberPhrasesHe, 'he'); // Numbers Hebrew, main display shows Hebrew
            });

            numberPhrases.forEach(phrase => {
                createButton({
                    display_text: phrase.thai, // Show Thai numeral on button
                    icon: '#ï¸âƒ£',
                    he_text: phrase.he_text,
                    th_text: phrase.thai,
                    he_audio_id: phrase.he_audio_id,
                    th_audio_id: phrase.th_audio_id,
                    is_urgent: false
                }, numberPhrasesTh, 'th'); // Numbers Thai, main display shows Thai
            });
        }


        // ××™×¨×•×¢×™ ×¤×•×¤××¤
        popupCloseButton.addEventListener('click', hidePopup);
        popupReplayButton.addEventListener('click', () => {
            if (popupAudioUrl) {
                playAudio(popupAudioUrl);
                // Reset popup close timeout after replaying audio
                clearTimeout(popupCloseTimeout);
                popupCloseTimeout = setTimeout(() => {
                    hidePopup();
                }, 2500);
            }
        });

        // ××ª×—×•×œ ××§×œ×“×ª ×•×™×¨×˜×•××œ×™×ª
        function initKeyboard() {
            keyboard = new SimpleKeyboard.default({
                onChange: input => {
                    document.getElementById('freeTextInput').value = input;
                    // When user types, clear main display and remove typing effect/rainbow border
                    mainDisplayText.textContent = input; // Display current input immediately
                    mainDisplayText.classList.remove('thai-text', 'typing-effect');
                    mainTranslationDisplay.classList.remove('rainbow-border');
                    if (currentKeyboardLayout === 'hebrew') {
                        mainDisplayText.style.direction = 'rtl';
                    } else {
                        mainDisplayText.style.direction = 'ltr';
                        mainDisplayText.classList.add('thai-text');
                    }
                },
                onKeyPress: button => {
                    if (button === "{shift}" || button === "{capslock}") {
                        handleShiftAndCaps();
                    }
                },
                layout: layoutOptions[currentKeyboardLayout],
                theme: "hg-theme-default hg-layout-numeric simple-keyboard", // Add class for custom styling
                display: {
                    '{bksp}': '××—×§',
                    '{tab}': '×˜××‘',
                    '{capslock}': '×§××¤×¡',
                    '{shift}': '×©×™×¤×˜',
                    '{space}': '×¨×•×•×—'
                }
            });
            // Initial focus on freeTextInput to show keyboard
            freeTextInput.focus();
        }

        function handleShiftAndCaps() {
            let currentLayout = keyboard.options.layoutName;
            let newLayout = currentLayout === "default" ? "shift" : "default";
            keyboard.setOptions({
                layoutName: newLayout
            });
        }

        // ×©×™× ×•×™ ×¤×¨×™×¡×ª ××§×œ×“×ª
        document.getElementById('setLangHe').addEventListener('click', () => {
            currentKeyboardLayout = 'hebrew';
            keyboard.setOptions({ layout: layoutOptions.hebrew, rtl: true });
            keyboard.setInput('');
            document.getElementById('freeTextInput').classList.remove('thai-text');
            document.getElementById('freeTextInput').style.direction = 'rtl';
            mainDisplayText.textContent = '×”×§×œ×“ ××©×”×• ××• ×‘×—×¨ ××©×¤×˜...';
            mainDisplayText.classList.remove('thai-text');
            mainDisplayText.style.direction = 'rtl';
            mainTranslationDisplay.classList.remove('rainbow-border');
        });

        document.getElementById('setLangTh').addEventListener('click', () => {
            currentKeyboardLayout = 'thai';
            keyboard.setOptions({ layout: layoutOptions.thai, rtl: false });
            keyboard.setInput('');
            document.getElementById('freeTextInput').classList.add('thai-text');
            document.getElementById('freeTextInput').style.direction = 'ltr';
            mainDisplayText.textContent = 'à¸à¸´à¸¡à¸à¹Œà¸­à¸°à¹„à¸£à¸šà¸²à¸‡à¸­à¸¢à¹ˆà¸²à¸‡à¸«à¸£à¸·à¸­à¹€à¸¥à¸·à¸­à¸à¸§à¸¥à¸µ...'; // Placeholder in Thai
            mainDisplayText.classList.add('thai-text');
            mainDisplayText.style.direction = 'ltr';
            mainTranslationDisplay.classList.remove('rainbow-border');
        });

        // ×ª×¨×’×•× ×˜×§×¡×˜ ×—×•×¤×©×™ (××•×“×œ ×’'××™× ×™)
        document.getElementById('speakTranslated').addEventListener('click', async () => {
            const freeTextInputValue = document.getElementById('freeTextInput').value.trim();
            if (!freeTextInputValue) {
                showPopup("×× × ×”×–×Ÿ ×˜×§×¡×˜ ×œ×ª×¨×’×•×.", "data:audio/mpeg;base64,", "ğŸš«", false); // Placeholder audio, no emoji for this popup
                return;
            }

            // ×”×•×¡×£ ×× ×™××¦×™×™×ª '×§×©×ª ×‘×¢× ×Ÿ' ×œ××¡×š ×”×ª×¨×’×•× ×‘×–××Ÿ ×”×˜×¢×™× ×”
            mainTranslationDisplay.classList.add('rainbow-border');
            mainDisplayText.textContent = '××ª×¨×’×...';
            mainDisplayText.classList.remove('thai-text', 'typing-effect'); // Ensure clean state
            mainDisplayText.style.direction = 'rtl'; // Direction for "××ª×¨×’×..."

            try {
                // ×§×‘×™×¢×ª ×©×¤×ª ×”××§×•×¨ ×•×”×™×¢×“ ×œ×ª×¨×’×•×
                let sourceLang = '';
                let targetLang = '';
                let displayDirection = 'rtl'; // Default for Hebrew
                if (currentKeyboardLayout === 'hebrew') {
                    sourceLang = 'he';
                    targetLang = 'th';
                    displayDirection = 'ltr'; // For translated Thai text
                } else {
                    sourceLang = 'th';
                    targetLang = 'he';
                    displayDirection = 'rtl'; // For translated Hebrew text
                }

                const prompt = `Translate the following text from ${sourceLang} to ${targetLang}: "${freeTextInputValue}"`;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                let translatedText = '';
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    translatedText = result.candidates[0].content.parts[0].text;
                } else {
                    translatedText = "×©×’×™××” ×‘×ª×¨×’×•×. ×× × × ×¡×” ×©×•×‘.";
                }

                // For Gemini, TTS generation requires an additional call.
                // Since built-in TTS is not available, we will display the translated text.
                // Here you would integrate a TTS service if available, and get Base64 audio.
                // For now, we simply display the translated text.

                mainTranslationDisplay.classList.remove('rainbow-border'); // Remove loading animation
                typeWriterEffect(translatedText, targetLang); // Display translation with typing effect

                // Example of playing audio if TTS were available
                // playAudio('data:audio/mpeg;base64,YOUR_GENERATED_TTS_AUDIO_BASE64_HERE');

            } catch (error) {
                console.error("×©×’×™××” ×‘×ª×¨×’×•×:", error);
                mainDisplayText.textContent = "××™×¨×¢×” ×©×’×™××” ×‘×ª×¨×’×•×. ×× × × ×¡×” ×©×•×‘.";
                mainTranslationDisplay.classList.remove('rainbow-border'); // Ensure animation is off
                mainDisplayText.classList.remove('thai-text'); // Ensure correct font/direction for error
                mainDisplayText.style.direction = 'rtl';
            }
        });


        // ××ª×—×•×œ ×”××¤×œ×™×§×¦×™×” ×œ××—×¨ ×˜×¢×™× ×ª ×”×“×£
        window.onload = () => {
            populatePanels();
            initKeyboard();
            // Set initial direction and text for freeTextInput and mainDisplayText
            freeTextInput.style.direction = 'rtl'; // Default to Hebrew input
            mainDisplayText.textContent = '×‘×¨×•×š ×”×‘×! ×‘×—×¨ ××©×¤×˜ ××• ×”×§×œ×“ ×œ×ª×¨×’×•×.';
            mainDisplayText.classList.remove('typing-effect'); // Ensure typing effect is not active on initial text
            mainDisplayText.style.direction = 'rtl';
        };
    </script>
</body>
</html>
